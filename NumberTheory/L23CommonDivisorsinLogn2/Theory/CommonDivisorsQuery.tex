\documentclass[12pt]{article}
\usepackage{enumitem}
\usepackage{fouriernc,amsmath}
\setlist[enumerate]{label*=\arabic*.}
\title{Number Theory : Common Divisors Query}
\date{}
\author{Brij Raj Kishore}

\begin{document}
	\maketitle
	Given $N$, you have to answer $Q$ queries, in each query you will be given a number K, you have to find count of common divisors of $N$ and $K$ \\
	$N \leq 10^{12}$ \\
	$K \leq 10^{12}$ \\
	$Q \leq 10^5$ \\
	$12$ $3$ \\
	$5 \\ 8 \\ 6 \\$
	$Q1 : 1 \{1\} \\ Q2 : 3 \{1, 2, 4\} \\ Q3 : 4 \{1, 2, 3, 6\}\\$


	\textbf{Naive Approach :} \\
	\begin{enumerate}
		\item Generate list of divisors of $N$ (can be done in $\mathcal{O}(\sqrt{N})$) 
		\item For each query : For each divisor d of N, if it also divides K, then cnt ++
	\end{enumerate}

	\textbf{Complexity Per Query : } $\mathcal{O}(\sqrt[\leftroot{-3}\uproot{3}3]{a})$ \\


	\textbf{Second Approach : } \\
	\begin{enumerate}
		\item Calculate GCD between $N$ and $K$, let it be $G$
		\item Find number of divisors of G
	\end{enumerate}
	
	\textbf{Complexity Per Query : } $\mathcal{O}(\log(max(N, K)) + \sqrt{G})$ \\


	\textbf{Next Approach : } \\

	Find and store Prime factorization of N \\
	$1800 = \{\{2, 3\}, \{3, 2\}, \{5, 2\}\}$ \\
	There are no more than $\log(N)$ primes factors for $N$ \\
	\begin{enumerate}
		\item Using each prime $p$ in prime factorization of $N$, factorize K \\
		$1800 = \{\{2, 3\}, \{3, 2\}, \{5, 2\}\}$ \\
		$200 = \{\{2, 3\}, \{3, 0\}, \{5, 1\}\}$
		
		\item For each prime find the minimum count, and calculate total divisors \\
		$\{\{2, 3\}, \{3, 0\}, \{5, 1\}\}$ \\
		$(3 + 1) \times (0 + 1) \times (1 + 1)$ \\

	\end{enumerate}

	\textbf{Overall Complexity : }
	$\mathcal{O}((\log{N})^2)$


\end{document}